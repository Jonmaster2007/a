-- Noclip Module (Loadstring version - clean, no admin framework)

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local LocalPlayer = Players.LocalPlayer
local Clip = true
local floatName = "HumanoidRootPart"
local Noclipping = nil

_G.NoclipModule = _G.NoclipModule or {}

local function NoclipStep()
	if not Clip and LocalPlayer.Character then
		for _, child in pairs(LocalPlayer.Character:GetDescendants()) do
			if child:IsA("BasePart") and child.CanCollide == true and child.Name ~= floatName then
				child.CanCollide = false
			end
		end
	end
end

function _G.NoclipModule.noclip()
	if Noclipping then return end
	Clip = false
	Noclipping = RunService.Stepped:Connect(NoclipStep)
end

function _G.NoclipModule.clip()
	Clip = true
	if Noclipping then
		Noclipping:Disconnect()
		Noclipping = nil
	end

	local char = LocalPlayer.Character
	if char then
		for _, child in pairs(char:GetDescendants()) do
			if child:IsA("BasePart") and child.Name ~= floatName then
				child.CanCollide = true
			end
		end
	end
end

function _G.NoclipModule.toggle()
	if Clip then
		_G.NoclipModule.noclip()
	else
		_G.NoclipModule.clip()
	end
end
